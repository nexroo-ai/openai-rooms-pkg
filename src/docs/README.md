# OpenAI - AI Rooms Workflow Addon

## Overview

Addon for Rooms AI to interact with the OpenAI API (Chat Completions).
It allows generating text from prompts with configurable parameters (model, temperature, tokens).

**Addon Type:** `openai`

## Features

- Text generation using OpenAIâ€™s Chat Completions endpoint.

## Add to Rooms AI using poetry

Using the script:

```bash
poetry add git+https://github.com/synvex-ai/openai-rooms-pkg.git
```

In the web interface, follow the online guide for adding an addon. You can also use JSON in the web interface.

## Configuration

### Addon Configuration

Add this addon to your AI Rooms workflow configuration:

```json
{
  "addons": [
    {
      "id": "openai-1",
      "type": "openai",
      "name": "OpenAI Addon",
      "description": "Text generation addon for OpenAI",
      "enabled": true,
      "config": {
        "type": "openai",
        "model": "gpt-3.5-turbo",
        "temperature": 0.7,
        "max_tokens": 1000
      },
      "secrets": {
        "openai_api_key": "ENV_OPENAI_API_KEY"
      }
    }
  ]
}
```

### Configuration Fields

#### BaseAddonConfig Fields

All addons inherit these base configuration fields:

| Field           | Type    | Required | Default | Description                              |
| --------------- | ------- | -------- | ------- | ---------------------------------------- |
| `id`          | string  | Yes      | -       | Unique identifier for the addon instance |
| `type`        | string  | Yes      | -       | Type of the addon (`openai`)           |
| `name`        | string  | Yes      | -       | Display name of the addon                |
| `description` | string  | Yes      | -       | Description of the addon                 |
| `enabled`     | boolean | No       | true    | Whether the addon is enabled             |

#### CustomAddonConfig Fields (OpenAI-specific)

This OpenAI addon adds these specific configuration fields:

| Field           | Type    | Required | Default       | Description                         |
| --------------- | ------- | -------- | ------------- | ----------------------------------- |
| `model`       | string  | No       | gpt-3.5-turbo | Default OpenAI model                |
| `temperature` | float   | No       | 0.7           | Randomness of generation            |
| `max_tokens`  | integer | No       | 1000          | Maximum tokens to generate per call |

### Required Secrets

| Secret Key         | Environment Variable   | Description                |
| ------------------ | ---------------------- | -------------------------- |
| `openai_api_key` | `ENV_OPENAI_API_KEY` | Your OpenAI API secret key |

### Environment Variables

Create a `.env` file in your workflow directory:

```bash
# .env file
ENV_OPENAI_API_KEY=sk-xxxxxxx
```

## Available Actions

### `generate_text`

Generate text using the OpenAI Chat Completions API.

**Parameters:**

- `prompt` (string, required): User input to generate a response.
- `model` (string, required): OpenAI model (e.g., `gpt-3.5-turbo`, `gpt-4o-mini`).
- `max_tokens` (integer, optional): Maximum number of tokens to generate.
- `temperature` (float, optional): Sampling temperature.

**Output Structure:**

- `generated_text` (string): Text generated by the model.
- `model_used` (string): Model actually used.
- `usage` (object): Token usage statistics.
- `timestamp` (string): ISO timestamp of generation.

**Workflow Usage Example:**

```json
{
  "id": "step-generate-text-1",
  "action": "openai-1::generate_text",
  "parameters": {
    "prompt": "Write a short poem about the beauty of nature.",
    "model": "gpt-3.5-turbo",
    "max_tokens": 300,
    "temperature": 0.7
  }
}
```

## Tools Support

This addon is **not** an agent-type addon, so it does not register tools.
It is focused on text generation only.

## Testing & Lint

Like all Rooms AI deployments, addons should be tested and linted.

### Running the Tests

```bash
poetry run pytest tests/ --cov=src/openai_rooms_pkg --cov-report=term-missing
```

### Running the linter

```bash
poetry run ruff check . --fix
```

### Pull Requests & Versioning

We use semantic versioning in CI/CD to automate versions.
Use the appropriate commit message syntax for semantic release in GitHub.

## Developers / Maintainers

- Romain Michaux : [romain.michaux@nexroo.com](mailto:romain.michaux@nexroo.com)
